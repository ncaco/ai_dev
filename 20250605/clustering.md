# 클러스터링(Clustering)

---

## 반복적 거리 기반 클러스터링 (Iterative Distance-based Clustering)

### k-평균(k-means) 알고리즘

- **k-means 알고리즘의 절차:**
  1. 클러스터 중심(cluster center)으로 임의의 $k$개 점을 선택합니다.
  2. 각 데이터 인스턴스를 가장 가까운 클러스터 중심에 할당합니다.
  3. 각 클러스터에 대해, 소속된 모든 인스턴스의 평균(centroid, 중심점)을 계산합니다.
  4. 계산된 중심점(centroid)을 새로운 클러스터 중심으로 지정합니다.
  5. 새로운 클러스터 중심을 기준으로 2~4단계를 반복합니다.
  6. 더 이상 클러스터 할당이 바뀌지 않을 때(즉, 같은 점들이 연속적으로 같은 클러스터에 할당될 때) 알고리즘을 종료합니다.

- **목표:**  
  - 모든 데이터 포인트가 속한 클러스터 중심까지의 **총 제곱 거리(total squared distance)**를 최소화합니다.

> **요약:**  
> k-means는 임의로 선택한 $k$개의 중심점에서 시작하여, 각 데이터 포인트를 가장 가까운 중심점에 할당하고, 각 클러스터의 중심을 반복적으로 갱신하는 방식으로 동작합니다.  
> 이 과정을 통해 각 클러스터 내의 데이터들이 중심점에 최대한 가깝게 모이도록 하며, 최종적으로 전체 데이터의 중심점까지의 제곱 거리 합이 최소가 되도록 클러스터를 형성합니다.

---

## 계층적 클러스터링(Hierarchical Clustering)

- **계층적 클러스터링**은 데이터를 트리 구조(덴드로그램, dendrogram)로 묶는 클러스터링 방법입니다.
- 대표적으로 두 가지 방식이 있습니다:
  - **병합적(agglomerative, bottom-up)**: 각 데이터를 개별 클러스터로 시작하여, 가장 가까운 두 클러스터를 반복적으로 합쳐가며 트리를 만듭니다.
  - **분할적(divisive, top-down)**: 전체 데이터를 하나의 클러스터로 시작하여, 반복적으로 클러스터를 분할해 나갑니다. (실제론 병합적 방식이 더 널리 사용됨)

- **덴드로그램(dendrogram)**:  
  - 클러스터 간의 결합 과정을 트리 형태로 시각화한 그래프입니다.
  - 트리의 높이는 클러스터 간의 거리(혹은 유사도)를 나타냅니다.

- **병합적 계층적 클러스터링(agglomerative hierarchical clustering) 절차:**
  1. 각 데이터를 하나의 클러스터로 간주합니다.
  2. 모든 클러스터 쌍 사이의 거리를 계산합니다.
  3. 가장 가까운 두 클러스터를 합칩니다.
  4. 클러스터가 하나만 남을 때까지 2~3단계를 반복합니다.

- **클러스터 간 거리(링크) 정의 방법:**
  - **단일 연결(single linkage):** 두 클러스터 간 가장 가까운 두 점 사이의 거리
  - **완전 연결(complete linkage):** 두 클러스터 간 가장 먼 두 점 사이의 거리
  - **평균 연결(average linkage):** 두 클러스터의 모든 점 쌍의 평균 거리
  - **중심 연결(centroid linkage):** 각 클러스터의 중심점(centroid) 간의 거리

> **요약:**  
> 계층적 클러스터링은 데이터를 트리 구조로 묶어가는 방법으로, 병합적(agglomerative) 방식이 가장 널리 쓰입니다.  
> 덴드로그램을 통해 클러스터링 과정을 시각적으로 확인할 수 있으며, 클러스터 간 거리 정의 방식에 따라 결과가 달라질 수 있습니다.


## 퍼지 클러스터링(Fuzzy Clustering) - Fuzzy C-Means

- **퍼지 클러스터링(Fuzzy Clustering)**은 각 데이터 포인트가 여러 클러스터에 부분적으로 소속될 수 있도록 허용하는 클러스터링 방법입니다.
- 대표적인 알고리즘: **Fuzzy C-Means (FCM)**

---

### Strict Clustering vs. Fuzzy Clustering

- **Strict Clustering(엄격 클러스터링):**
  - 각 데이터 포인트는 오직 하나의 클러스터에만 소속됩니다.
  - 데이터가 가장 가까운 클러스터에 명확하게 할당되며, 중복되거나 모호한 소속이 허용되지 않습니다.
  - (왼쪽 그림 (a) 참고: 각 점이 하나의 클러스터에만 속함)

- **Fuzzy Clustering(퍼지 클러스터링):**
  - 각 데이터 포인트가 두 개 이상의 클러스터에 부분적으로 소속될 수 있습니다.
  - 각 클러스터에 속하는 정도(소속도, membership)로 표현되며, 소속도의 합은 1이 됩니다.
  - 데이터 포인트가 해당 클러스터에 속할 "확률" 또는 "가까움"의 정도를 수치로 나타냅니다.
  - (오른쪽 그림 (b) 참고: 점의 색이 여러 클러스터에 걸쳐 흐릿하게 표현됨)

---

#### Fuzzy C-Means(FCM) 알고리즘 개요

1. 클러스터의 개수 $c$와 퍼지 계수 $m > 1$을 정합니다. ($m$이 클수록 소속도가 더 퍼지게 됨)
2. 각 데이터 포인트 $x_i$와 클러스터 $j$에 대해 소속도 $u_{ij}$를 임의로 초기화합니다. ($u_{ij} \in [0,1]$, $\sum_j u_{ij} = 1$)
3. 클러스터 중심 $v_j$를 다음과 같이 계산합니다:
   $$
   v_j = \frac{\sum_i u_{ij}^m x_i}{\sum_i u_{ij}^m}
   $$
4. 각 데이터 포인트 $x_i$의 소속도 $u_{ij}$를 다음과 같이 갱신합니다:
   $$
   u_{ij} = \frac{1}{\sum_{k=1}^c \left(\frac{||x_i - v_j||}{||x_i - v_k||}\right)^{2/(m-1)}}
   $$
5. 소속도와 중심점이 수렴할 때까지 3~4단계를 반복합니다.

---

#### 요약

- **Strict Clustering**: 각 데이터는 하나의 클러스터에만 소속 (소속도 0 또는 1)
- **Fuzzy Clustering**: 각 데이터는 여러 클러스터에 부분적으로 소속 (소속도 0~1, 합은 1)
- 퍼지 클러스터링은 데이터의 경계가 모호하거나, 중첩된 군집 구조를 더 유연하게 표현할 수 있습니다.

> **참고:**  
> 위 그림에서 (a)는 Strict Clustering, (b)는 Fuzzy Clustering의 개념을 시각적으로 보여줍니다.  
> Fuzzy Clustering에서는 점의 색이 여러 클러스터에 걸쳐 흐릿하게 표현되어, 소속도의 연속적 변화를 나타냅니다.
